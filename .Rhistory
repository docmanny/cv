y= if_else(str_detect(y, "Idionycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Leptonycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Glosophaga"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Tadarida"),"Molossidae", y)
y= if_else(str_detect(y, "Rousettus"),"Pteropodidae", y)
y= if_else(str_detect(y, "Eidolon"),"Pteropodidae", y)
y= if_else(str_detect(y, "Pteropus"),"Pteropodidae", y)
return(y)
}
)
) %>%
ggplot(
aes(
x=Count,
y=Species,
fill=Clade
)
) +
geom_bar(stat="identity") +
scale_fill_manual(values=color_scheme, guide=guide_legend(direction = 'vertical')) +
#scale_fill_brewer(palette="Dark2") +
theme_pubr() +
labs_pubr() +
theme(legend.position = c(0.8,0.75))
cells %>%
mutate(Species = factor(Species, levels=Species %>% unique),
Clade = sapply(
Species,
function(x){
y= if_else(str_detect(x, "Myotis"), "Myotinae",x)
y= if_else(str_detect(y, "Perimyotis"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Parastrellus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Eptesicus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasiurus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasionycteris"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Corynorhinus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Antrozous"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Idionycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Leptonycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Glosophaga"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Tadarida"),"Molossidae", y)
y= if_else(str_detect(y, "Rousettus"),"Pteropodidae", y)
y= if_else(str_detect(y, "Eidolon"),"Pteropodidae", y)
y= if_else(str_detect(y, "Pteropus"),"Pteropodidae", y)
return(y)
}
)
) %>%
ggplot(
aes(
x=Count,
y=Species,
fill=Clade
)
) +
geom_bar(stat="identity") +
scale_fill_manual(values=color_scheme, guide=guide_legend(direction = 'vertical')) +
#scale_fill_brewer(palette="Dark2") +
theme_pubr() +
labs_pubr() +
theme(legend.position = c(0.8,0.5))
cells %>%
mutate(Species = factor(Species, levels=Species %>% unique),
Clade = sapply(
Species,
function(x){
y= if_else(str_detect(x, "Myotis"), "Myotinae",x)
y= if_else(str_detect(y, "Perimyotis"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Parastrellus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Eptesicus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasiurus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasionycteris"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Corynorhinus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Antrozous"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Idionycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Leptonycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Glosophaga"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Tadarida"),"Molossidae", y)
y= if_else(str_detect(y, "Rousettus"),"Pteropodidae", y)
y= if_else(str_detect(y, "Eidolon"),"Pteropodidae", y)
y= if_else(str_detect(y, "Pteropus"),"Pteropodidae", y)
return(y)
}
)
) %>%
ggplot(
aes(
x=Count,
y=Species,
fill=Clade
)
) +
geom_bar(stat="identity") +
scale_fill_manual(values=color_scheme, guide=guide_legend(direction = 'vertical')) +
#scale_fill_brewer(palette="Dark2") +
theme_pubr() +
labs_pubr() +
theme(legend.position = c(0.75,0.5))
cells %>%
mutate(Species = factor(Species, levels=Species %>% unique),
Clade = sapply(
Species,
function(x){
y= if_else(str_detect(x, "Myotis"), "Myotinae",x)
y= if_else(str_detect(y, "Perimyotis"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Parastrellus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Eptesicus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasiurus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasionycteris"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Corynorhinus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Antrozous"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Idionycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Leptonycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Glosophaga"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Tadarida"),"Molossidae", y)
y= if_else(str_detect(y, "Rousettus"),"Pteropodidae", y)
y= if_else(str_detect(y, "Eidolon"),"Pteropodidae", y)
y= if_else(str_detect(y, "Pteropus"),"Pteropodidae", y)
return(y)
}
)
) %>%
ggplot(
aes(
x=Count,
y=Species,
fill=Clade
)
) +
geom_bar(stat="identity") +
scale_fill_manual(values=color_scheme, guide=guide_legend(direction = 'vertical')) +
#scale_fill_brewer(palette="Dark2") +
theme_pubr() +
labs_pubr() +
theme(legend.position = c(0.75,0.25))
color_scheme <- c(
"Myotinae" = "#F93943",
"Vespertillionidae" = "#FCB0B3",
"Phyllostomidae" = "#7EB2DD",
"Molossidae" = "#9CDE9F",
"Pteropodidae" = "#FBB13C"
)
cells %>%
mutate(Species = factor(Species, levels=Species %>% unique),
Clade = sapply(
Species,
function(x){
y= if_else(str_detect(x, "Myotis"), "Myotinae",x)
y= if_else(str_detect(y, "Perimyotis"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Parastrellus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Eptesicus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasiurus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasionycteris"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Corynorhinus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Antrozous"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Idionycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Leptonycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Glosophaga"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Tadarida"),"Molossidae", y)
y= if_else(str_detect(y, "Rousettus"),"Pteropodidae", y)
y= if_else(str_detect(y, "Eidolon"),"Pteropodidae", y)
y= if_else(str_detect(y, "Pteropus"),"Pteropodidae", y)
return(y)
}
)
) %>%
ggplot(
aes(
x=Count,
y=Species,
fill=Clade
)
) +
geom_bar(stat="identity") +
scale_fill_manual(values=color_scheme, guide=guide_legend(direction = 'vertical')) +
#scale_fill_brewer(palette="Dark2") +
theme_pubr() +
labs_pubr() +
theme(legend.position = c(0.75,0.25))
7EB2DD
7EB2DD
cells %>%
mutate(Species = factor(Species, levels=Species %>% unique),
Clade = sapply(
Species,
function(x){
y= if_else(str_detect(x, "Myotis"), "Myotinae",x)
y= if_else(str_detect(y, "Perimyotis"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Parastrellus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Eptesicus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasiurus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasionycteris"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Corynorhinus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Antrozous"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Idionycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Leptonycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Glosophaga"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Tadarida"),"Molossidae", y)
y= if_else(str_detect(y, "Rousettus"),"Pteropodidae", y)
y= if_else(str_detect(y, "Eidolon"),"Pteropodidae", y)
y= if_else(str_detect(y, "Pteropus"),"Pteropodidae", y)
return(y)
}
)
) %>%
ggplot(
aes(
x=Count,
y=Species,
fill=Clade
)
) +
geom_bar(stat="identity") +
scale_fill_manual(values=color_scheme, guide=guide_legend(direction = 'vertical', reverse = T)) +
#scale_fill_brewer(palette="Dark2") +
theme_pubr() +
labs_pubr() +
theme(legend.position = c(0.75,0.25))
cells %>%
mutate(Species = factor(Species, levels=Species %>% unique),
Clade = sapply(
Species,
function(x){
y= if_else(str_detect(x, "Myotis"), "Myotinae",x)
y= if_else(str_detect(y, "Perimyotis"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Parastrellus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Eptesicus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasiurus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasionycteris"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Corynorhinus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Antrozous"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Idionycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Leptonycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Glosophaga"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Tadarida"),"Molossidae", y)
y= if_else(str_detect(y, "Rousettus"),"Pteropodidae", y)
y= if_else(str_detect(y, "Eidolon"),"Pteropodidae", y)
y= if_else(str_detect(y, "Pteropus"),"Pteropodidae", y)
return(y)
}
)
) %>%
ggplot(
aes(
x=Count,
y=Species,
fill=Clade
)
) +
geom_bar(stat="identity") +
scale_fill_manual(values=color_scheme, guide=guide_legend(direction = 'vertical', order=1)) +
#scale_fill_brewer(palette="Dark2") +
theme_pubr() +
labs_pubr() +
theme(legend.position = c(0.75,0.25))
cells %>%
mutate(Species = factor(Species, levels=Species %>% unique),
Clade = sapply(
Species,
function(x){
y= if_else(str_detect(x, "Myotis"), "Myotinae",x)
y= if_else(str_detect(y, "Perimyotis"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Parastrellus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Eptesicus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasiurus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasionycteris"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Corynorhinus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Antrozous"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Idionycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Leptonycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Glosophaga"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Tadarida"),"Molossidae", y)
y= if_else(str_detect(y, "Rousettus"),"Pteropodidae", y)
y= if_else(str_detect(y, "Eidolon"),"Pteropodidae", y)
y= if_else(str_detect(y, "Pteropus"),"Pteropodidae", y)
return(y)
}
)
) %>%
ggplot(
aes(
x=Count,
y=Species,
fill=Clade
)
) +
geom_bar(stat="identity") +
scale_fill_manual(values=color_scheme, guide=guide_legend(direction = 'vertical', order=2)) +
#scale_fill_brewer(palette="Dark2") +
theme_pubr() +
labs_pubr() +
theme(legend.position = c(0.75,0.25))
cells %>%
mutate(Species = factor(Species, levels=Species %>% unique),
Clade = sapply(
Species,
function(x){
y= if_else(str_detect(x, "Myotis"), "Myotinae",x)
y= if_else(str_detect(y, "Perimyotis"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Parastrellus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Eptesicus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasiurus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasionycteris"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Corynorhinus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Antrozous"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Idionycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Leptonycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Glosophaga"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Tadarida"),"Molossidae", y)
y= if_else(str_detect(y, "Rousettus"),"Pteropodidae", y)
y= if_else(str_detect(y, "Eidolon"),"Pteropodidae", y)
y= if_else(str_detect(y, "Pteropus"),"Pteropodidae", y)
return(y)
}
)
) %>%
ggplot(
aes(
x=Count,
y=Species,
fill=Clade
)
) +
geom_bar(stat="identity") +
scale_fill_manual(values=color_scheme, guide=guide_legend(direction = 'vertical', order=99)) +
#scale_fill_brewer(palette="Dark2") +
theme_pubr() +
labs_pubr() +
theme(legend.position = c(0.75,0.25))
cells %>%
mutate(Species = factor(Species, levels=Species %>% unique),
Clade = sapply(
Species,
function(x){
y= if_else(str_detect(x, "Myotis"), "Myotinae",x)
y= if_else(str_detect(y, "Perimyotis"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Parastrellus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Eptesicus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasiurus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasionycteris"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Corynorhinus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Antrozous"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Idionycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Leptonycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Glosophaga"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Tadarida"),"Molossidae", y)
y= if_else(str_detect(y, "Rousettus"),"Pteropodidae", y)
y= if_else(str_detect(y, "Eidolon"),"Pteropodidae", y)
y= if_else(str_detect(y, "Pteropus"),"Pteropodidae", y)
return(y)
}
)
) %>%
ggplot(
aes(
x=Count,
y=Species,
fill=Clade
)
) +
geom_bar(stat="identity") +
scale_fill_manual(values=color_scheme, guide=guide_legend(direction = 'vertical', order=c(1,2,3,4,5))) +
#scale_fill_brewer(palette="Dark2") +
theme_pubr() +
labs_pubr() +
theme(legend.position = c(0.75,0.25))
cells %>%
mutate(Species = factor(Species, levels=Species %>% unique),
Clade = sapply(
Species,
function(x){
y= if_else(str_detect(x, "Myotis"), "Myotinae",x)
y= if_else(str_detect(y, "Perimyotis"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Parastrellus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Eptesicus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasiurus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasionycteris"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Corynorhinus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Antrozous"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Idionycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Leptonycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Glosophaga"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Tadarida"),"Molossidae", y)
y= if_else(str_detect(y, "Rousettus"),"Pteropodidae", y)
y= if_else(str_detect(y, "Eidolon"),"Pteropodidae", y)
y= if_else(str_detect(y, "Pteropus"),"Pteropodidae", y)
return(y)
}
)
) %>%
ggplot(
aes(
x=Count,
y=Species,
fill=Clade
)
) +
geom_bar(stat="identity") +
scale_fill_manual(values=color_scheme, breaks=names(color_scheme),guide=guide_legend(direction = 'vertical', order=)) +
#scale_fill_brewer(palette="Dark2") +
theme_pubr() +
labs_pubr() +
theme(legend.position = c(0.75,0.25))
cells %>%
mutate(Species = factor(Species, levels=Species %>% unique),
Clade = sapply(
Species,
function(x){
y= if_else(str_detect(x, "Myotis"), "Myotinae",x)
y= if_else(str_detect(y, "Perimyotis"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Parastrellus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Eptesicus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasiurus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasionycteris"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Corynorhinus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Antrozous"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Idionycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Leptonycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Glosophaga"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Tadarida"),"Molossidae", y)
y= if_else(str_detect(y, "Rousettus"),"Pteropodidae", y)
y= if_else(str_detect(y, "Eidolon"),"Pteropodidae", y)
y= if_else(str_detect(y, "Pteropus"),"Pteropodidae", y)
return(y)
}
)
) %>%
ggplot(
aes(
x=Count,
y=Species,
fill=Clade
)
) +
geom_bar(stat="identity") +
scale_fill_manual(values=color_scheme, breaks=names(color_scheme),guide=guide_legend(direction = 'vertical', order=)) +
geom_text(aes(label=Count), face=bold, hjust=0)
cells %>%
mutate(Species = factor(Species, levels=Species %>% unique),
Clade = sapply(
Species,
function(x){
y= if_else(str_detect(x, "Myotis"), "Myotinae",x)
y= if_else(str_detect(y, "Perimyotis"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Parastrellus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Eptesicus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasiurus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasionycteris"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Corynorhinus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Antrozous"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Idionycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Leptonycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Glosophaga"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Tadarida"),"Molossidae", y)
y= if_else(str_detect(y, "Rousettus"),"Pteropodidae", y)
y= if_else(str_detect(y, "Eidolon"),"Pteropodidae", y)
y= if_else(str_detect(y, "Pteropus"),"Pteropodidae", y)
return(y)
}
)
) %>%
ggplot(
aes(
x=Count,
y=Species,
fill=Clade
)
) +
geom_bar(stat="identity") +
scale_fill_manual(values=color_scheme, breaks=names(color_scheme),guide=guide_legend(direction = 'vertical', order=)) +
geom_text(aes(label=Count), face="bold", hjust=0) +
theme_pubr() +
labs_pubr() +
theme(legend.position = c(0.75,0.25))
cells %>%
mutate(Species = factor(Species, levels=Species %>% unique),
Clade = sapply(
Species,
function(x){
y= if_else(str_detect(x, "Myotis"), "Myotinae",x)
y= if_else(str_detect(y, "Perimyotis"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Parastrellus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Eptesicus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasiurus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Lasionycteris"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Corynorhinus"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Antrozous"),"Vespertillionidae", y)
y= if_else(str_detect(y, "Idionycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Leptonycteris"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Glosophaga"),"Phyllostomidae", y)
y= if_else(str_detect(y, "Tadarida"),"Molossidae", y)
y= if_else(str_detect(y, "Rousettus"),"Pteropodidae", y)
y= if_else(str_detect(y, "Eidolon"),"Pteropodidae", y)
y= if_else(str_detect(y, "Pteropus"),"Pteropodidae", y)
return(y)
}
)
) %>%
ggplot(
aes(
x=Count,
y=Species,
fill=Clade
)
) +
geom_bar(stat="identity") +
scale_fill_manual(values=color_scheme, breaks=names(color_scheme),guide=guide_legend(direction = 'vertical', order=)) +
geom_text(aes(label=Count), fontface="bold", hjust=0) +
theme_pubr() +
labs_pubr() +
theme(legend.position = c(0.75,0.25))
cells %>% pull(Species) %>% unique %>% length
